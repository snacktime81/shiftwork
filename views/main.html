<!DOCTYPE html>
<html>
 	<head>
    	<title>{{title}}</title>
		<style>
			table {
			  border-collapse: collapse;
			  width: 100%;
			}

			th, td {
			  text-align: center;
			  padding: 8px;
			  border: 1px solid #ddd;
			}
	
			 #color{
			  background-color: #FFFF00;
			}
			
			#login_button{
				position: relative;
				left: 88%;	
				float: left;
				margin:1px;
			
			}
			#join_button{
				position: relative;
				left: 88%;	
				float: left;
				margin: 1px;
			}
		
			.container {
				display: flex;
			}
		
			input[type="submit"] {
				width: 100%;
				padding: 10px;
				background-color: #000;
				color: #fff;
				border: 1px solid #000;
				cursor: pointer;
			}
  		</style>
		<script src="https://unpkg.com/axios/dist/axios.min.js"></script>

  	</head>
	<body>
		<div class='container' id='login_button'>
		</div>
		<div class='container' id='join_button'>
		</div>
		<h1>
			 Day 1
		</h1>
	<div id = 'day1' class='container'>
		<table id = "day1Table">
			<thead>
				<tr>
					<th>날짜</th>
					<th>장비</th>
					<th>이름</th>
					{% set allOfTime = [7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,1,2,3,4,5,6] %}
					{% for i in allOfTime %}
						<th id={{ i }}>{{i}}</th>
					{% endfor %}
				</tr>
			</thead>
			<tbody>
				{% for time in times %}
				<tr>
					<td> {{time.day}} </td>
					<td>{{time.machine}}</td>
					<td>{{time.User.name}}</td>
					{% set allOfNum = [7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30] %}
					{% set num = 7 %}
					{% for i in allOfNum %}
						{% if num > (time.starttime - 1) and (time.endtime ) > num %}
							<td id='color'></td>
						{% else %}
							<td></td>
						{% endif %}
						{% set num = num + 1 %}
					{% endfor %}
				</tr>
				{% endfor %}
			</tbody>
		</table>

	</div>
	<script>
		async function axiosExample() {
			const response = await axios.get('/auth/status');
			return response;
			}
		
		async function axiosAuthStatus(){
			const authStatus = await axios.get('/time/status');
			return authStatus;
		}
		
		
		axiosExample().then(function(re){
			
			const status = re.data
			if(status){
				let form = document.createElement('form');
				form.action = 'auth/logout';
				form.method = 'get';
				form.id = 'loginForm';
				
				let input = document.createElement('input');
				input.type = 'submit';
				input.value = '로그아웃';
				
				form.appendChild(input);

				let div = document.querySelector('#login_button');
				div.appendChild(form);
				
				axiosAuthStatus().then(function(reAuth){
					const authStatus = reAuth.data;
					console.log(authStatus);
					if(authStatus){
						form = document.createElement('form');
						form.action = '/time';
						form.method = 'get';
						form.id = 'joinForm';

						input = document.createElement('input');
						input.type = 'submit';
						input.value = '시간생성';

						form.appendChild(input);

						div = document.querySelector('#join_button');
						div.appendChild(form);
					}
				})
				
			}
			else{
				let form = document.createElement('form');
				form.action = 'auth/login';
				form.method = 'get';
				form.id = 'loginForm';

				
				let input = document.createElement('input');
				input.type = 'submit';
				input.value = '로그인';
				
				form.appendChild(input);
				
				let div = document.querySelector('#login_button');
				div.appendChild(form);
				
				
				form = document.createElement('form');
				form.action = '/join';
				form.method = 'get';
				form.id = 'joinForm';
				
				input = document.createElement('input');
				input.type = 'submit';
				input.value = '회원가입';
				
				form.appendChild(input);

				div = document.querySelector('#join_button');
				div.appendChild(form);
			}
		});

			
	</script>	
	</body>
</html>